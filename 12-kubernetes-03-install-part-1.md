# Домашнее задание к занятию "12.3 Развертывание кластера на собственных серверах, лекция 1"
Поработав с персональным кластером, можно заняться проектами. Вам пришла задача подготовить кластер под новый проект.

## Задание 1: Описать требования к кластеру
Сначала проекту необходимо определить требуемые ресурсы. Известно, что проекту нужны база данных, система кеширования, а само приложение состоит из бекенда и фронтенда. Опишите, какие ресурсы нужны, если известно:

* База данных должна быть отказоустойчивой. Потребляет 4 ГБ ОЗУ в работе, 1 ядро. 3 копии.
* Кэш должен быть отказоустойчивый. Потребляет 4 ГБ ОЗУ в работе, 1 ядро. 3 копии.
* Фронтенд обрабатывает внешние запросы быстро, отдавая статику. Потребляет не более 50 МБ ОЗУ на каждый экземпляр, 0.2 ядра. 5 копий.
* Бекенд потребляет 600 МБ ОЗУ и по 1 ядру на копию. 10 копий.

## Как оформить ДЗ?

Выполненное домашнее задание пришлите ссылкой на .md-файл в вашем репозитории.

План расчета
1. Сначала сделайте расчет всех необходимых ресурсов.
2. Затем прикиньте количество рабочих нод, которые справятся с такой нагрузкой.
3. Добавьте к полученным цифрам запас, который учитывает выход из строя как минимум одной ноды.
4. Добавьте служебные ресурсы к нодам. Помните, что для разных типов нод требовния к ресурсам разные.
5. Рассчитайте итоговые цифры.
6. В результате должно быть указано количество нод и их параметры.

---

# Ответ

## Задание 1

Минимальные ресурсы необходимые для разворачивания нод кластера

|               | CPU       | RAM      | HDD     |
| ------------- | --------- | -------- | ------- |
| Control Plane |   2 ядра  |     2 ГБ | 50 ГБ   |
| Worker Node   |   1 ядра  |     1 ГБ | 100 ГБ  |

Необходимые ресурсы для проекта

|          | CPU | RAM  | Replicas | Sum CPU | Sum RAM |
| -------- | --- | ---- | -------- | ------- | ------- |
| БД       | 1   | 4    | 3        | 3       | 12      |
| Кеш      | 1   | 4    | 3        | 3       | 12      |
| Фронтенд | 0,2 | 0,05 | 5        | 1       | 0,25    |
| Бекенд   | 1   | 0,6  | 10       | 10      | 6       |

Расчёт количества рабочих нод кластера для проекта:
- Control Plane - 3 ноды, в минимальной конфигурации 2 CPU, 2 RAM
- Worker Node
  - БД - 3 ноды, конфигурация ноды 1 CPU, 4 RAM
  - Кеш - 3 ноды, конфигурация ноды 1 CPU, 4 RAM
  - Фронтенд - 2 ноды, конфигурация ноды 0,5 CPU, 0,125 RAM
  - Бекенд - 2 ноды, конфигурация ноды 5 CPU, 3 RAM

Дополнительные ресурсы
- По одной ноде для каждого сервиса аналогичного размера
- Служебные ресурсы на работу каждой Worker Node 1 CPU, 1 RAM

Итоговый размер кластера

|               | CPU node | RAM node | Колв-во нод | Sum CPU | Sum RAM |
| ------------- | -------- | -------- | ----------- | ------- | ------- |
| БД            | 2        | 5        | 4           | 8       | 20      |
| Кеш           | 2        | 5        | 4           | 8       | 20      |
| Фронтенд      | 1,5      | 1,125    | 3           | 4,5     | 3,375   |
| Бекенд        | 6        | 4        | 3           | 18      | 12      |
| Control Plane | 2        | 2        | 3           | 6       | 6       |
| Итого         | 14       | 17,12    | 17          | 44,5    | 61,375  |

Фронтенд и бекенд можно разместить и на одних нодах, тем самым уменьшив количество нод, но пропорционально увеличив их размер.