# Домашнее задание к занятию "4.1. Командная оболочка Bash: Практические навыки"

## Обязательные задания

1. Есть скрипт:
    ```bash
    a=1
    b=2
    c=a+b
    d=$a+$b
    e=$(($a+$b))
    ```
    * Какие значения переменным c,d,e будут присвоены?
    * Почему?
    ```bash
    vagrant@vagrant-vm1:~$ c=a+b
    vagrant@vagrant-vm1:~$ echo $c
    a+b - в "c" просто поместили символы
 
    vagrant@vagrant-vm1:~$ d=$a+$b
    vagrant@vagrant-vm1:~$ echo $d
    1+2 - в "d" поместили переменные и объединили их "+"
 
    vagrant@vagrant-vm1:~$ e=$(($a+$b))
    vagrant@vagrant-vm1:~$ echo $e
    3 - в "e" поместили переменные, закрыли их скобками и "$" поэтому выполнилась арефметичекая операция с переменными
    ```

2. На нашем локальном сервере упал сервис и мы написали скрипт, который постоянно проверяет его доступность, записывая дату проверок до тех пор, пока сервис не станет доступным. В скрипте допущена ошибка, из-за которой выполнение не может завершиться, при этом место на Жёстком Диске постоянно уменьшается. Что необходимо сделать, чтобы его исправить:
    ```bash
    while ((1==1)
    do
    curl https://localhost:4757
    if (($? != 0))
    then
    date >> curl.log
    fi
    done
    ```
   1. Первая ошибка не хватает закрывающей скобки в конструкции `while ((1==1)`. После добавления закрывающей `)` скрипт уже работает как надо, если опираться на "скрипт, который постоянно проверяет"
   2. Если идти дальше по задаче "выполнение не может завершиться", тогда можно добавить блок `else` в которую поместить `break`, тогда будет происходить прерывание скрипта при доступности ресурса.
   3. Ещё можно добавить `sleep`, для того, что бы проводить проверки не так часто, с-но меньше писать в лог
    ```bash
    #!/usr/bin/env bash
    while ((1==1))
    do
    curl https://localhost:4757
    if (($? != 0))
    then
    date >> curl.log
    else
    break
    fi
    sleep 5
    done
    ```
3. Необходимо написать скрипт, который проверяет доступность трёх IP: 192.168.0.1, 173.194.222.113, 87.250.250.242 по 80 порту и записывает результат в файл log. Проверять доступность необходимо пять раз для каждого узла.  
   1. 
    ```bash
    #!/usr/bin/env bash
	
    urls=('192.168.0.1' '173.194.222.113' '87.250.250.242')
	
    for url in ${urls[@]}
    do
     a=5
     while (($a > 0))
     do
      let "a -= 1"
      curl $url:80 1> /dev/null
      if (($? == 0))
       then
       echo URL $url available >> curl.log
      fi
      done
    done
    ```

4. Необходимо дописать скрипт из предыдущего задания так, чтобы он выполнялся до тех пор, пока один из узлов не окажется недоступным. Если любой из узлов недоступен - IP этого узла пишется в файл error, скрипт прерывается  
   1. 
	```bash
	#!/usr/bin/env bash
	
	urls=('192.168.0.1' '173.194.222.113' '87.250.250.242')
	
	while ((1==1))
	do
	 for url in ${urls[@]}
	 do
	  a=5
	  while (($a > 0))
	  do
	   let "a -= 1"
	   curl $url:80 1> /dev/null
	   if (($? == 0))
		then
		echo URL $url available >> curl.log
	   else
		echo URL $url not available >> error.log
		exit
	   fi
	  sleep 2
	  done
	 done
	done
	```

## Дополнительное задание (со звездочкой*) - необязательно к выполнению

Мы хотим, чтобы у нас были красивые сообщения для коммитов в репозиторий. Для этого нужно написать локальный хук для git, который будет проверять, что сообщение в коммите содержит код текущего задания в квадратных скобках и количество символов в сообщении не превышает 30. Пример сообщения: \[04-script-01-bash\] сломал хук.